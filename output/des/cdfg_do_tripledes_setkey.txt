
digraph do_tripledes_setkey {
    rankdir=TB;
    
    // Nodes with their labels and shapes
    1 [label="Check selftest_failed" shape=diamond xlabel="selftest_failed"];
    2 [label="Check keylen ==24" shape=diamond xlabel="keylen !=24"];
    3 [label="Call tripledes_set3keys(ctx, key, key+8, key+16)" shape=box];
    4 [label="Check is_weak_key for all keys" shape=diamond xlabel="is_weak_key"];
    5 [label="Return 0" shape=doublecircle];
    
    // Error return nodes
    e_selftest [label="G10ERR_SELFTEST_FAILED" shape=none];
    e_keylen [label="G10ERR_WRONG_KEYLEN" shape=none];
    e_weakkey [label="G10ERR_WEAK_KEY" shape=none];

    // Edges with conditions and labels
    1 -> e_selftest [label="True"];
    1 -> 2 [label="False"];

    2 -> e_keylen [label="True"];
    2 -> 3 [label="False"];

    3 ->4;

    4 -> e_weakkey [label="True"];
    4 ->5 [label="False"];

    // Styling edges
    edge [arrowhead=vee, arrowsize=1];
}

This graph shows each decision point as a diamond, with edges labeled by the condition. Each error return is represented as a sink node. The data flow for each operation is noted in the xlabel.